<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Summary LiveCode v9.6.1 for Windows is vulnerable to a horizontal privilege escalation vulnerability.
CVE Mitre Assigned: CVE-2020-26894
Discovery While taking a Wildlife Issues course at my University, I discovered a high severity vulnerability in the course software our class was using that leads to a horizontal privilege escalation.
At first, I thought the vulnerability was only in this course software, but looking into it deeper and with the help of one of the developers at faulkner press, we discovered that the vulnerability actually lied in the programming language/framework they were using: LiveCode." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://john-woodman.com/research/2020-10-21-livecode-privilege-escalation-vulnerability/" />


    <title>
        
            CVE-2020-26894 Privilege Escalation Vulnerability in LiveCode v9.6.1 Programming Language :: John Woodman&#39;s Security Blog 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.393856bf2c430bb6c01d7af07c6fe966e7cce8073435cfbbc46e590bab7405ef.css">






<meta itemprop="name" content="CVE-2020-26894 Privilege Escalation Vulnerability in LiveCode v9.6.1 Programming Language">
<meta itemprop="description" content="Summary LiveCode v9.6.1 for Windows is vulnerable to a horizontal privilege escalation vulnerability.
CVE Mitre Assigned: CVE-2020-26894
Discovery While taking a Wildlife Issues course at my University, I discovered a high severity vulnerability in the course software our class was using that leads to a horizontal privilege escalation.
At first, I thought the vulnerability was only in this course software, but looking into it deeper and with the help of one of the developers at faulkner press, we discovered that the vulnerability actually lied in the programming language/framework they were using: LiveCode.">

<meta itemprop="wordCount" content="439">
<meta itemprop="image" content="https://john-woodman.com/"/>



<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://john-woodman.com/"/>

<meta name="twitter:title" content="CVE-2020-26894 Privilege Escalation Vulnerability in LiveCode v9.6.1 Programming Language"/>
<meta name="twitter:description" content="Summary LiveCode v9.6.1 for Windows is vulnerable to a horizontal privilege escalation vulnerability.
CVE Mitre Assigned: CVE-2020-26894
Discovery While taking a Wildlife Issues course at my University, I discovered a high severity vulnerability in the course software our class was using that leads to a horizontal privilege escalation.
At first, I thought the vulnerability was only in this course software, but looking into it deeper and with the help of one of the developers at faulkner press, we discovered that the vulnerability actually lied in the programming language/framework they were using: LiveCode."/>



    <meta property="og:title" content="CVE-2020-26894 Privilege Escalation Vulnerability in LiveCode v9.6.1 Programming Language" />
<meta property="og:description" content="Summary LiveCode v9.6.1 for Windows is vulnerable to a horizontal privilege escalation vulnerability.
CVE Mitre Assigned: CVE-2020-26894
Discovery While taking a Wildlife Issues course at my University, I discovered a high severity vulnerability in the course software our class was using that leads to a horizontal privilege escalation.
At first, I thought the vulnerability was only in this course software, but looking into it deeper and with the help of one of the developers at faulkner press, we discovered that the vulnerability actually lied in the programming language/framework they were using: LiveCode." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://john-woodman.com/research/2020-10-21-livecode-privilege-escalation-vulnerability/" />
<meta property="og:image" content="https://john-woodman.com/"/>
<meta property="og:site_name" content="John Woodman&#39;s Security Blog" />




    <meta property="article:section" content="posts" />










    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">Security Blog</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://john-woodman.com/about">About</a></li><li><a href="https://john-woodman.com/gardening">Gardening</a></li><li><a href="https://john-woodman.com/research">Security</a></li><li><a href="https://john-woodman.com/writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://john-woodman.com/research/2020-10-21-livecode-privilege-escalation-vulnerability/">CVE-2020-26894 Privilege Escalation Vulnerability in LiveCode v9.6.1 Programming Language</a></h2>

            

            

            <div class="post-content">
                <h1 id="header-1summary"><a href="#header-1"></a>Summary</h1>
<p>LiveCode v9.6.1 for Windows is vulnerable to a horizontal privilege escalation vulnerability.</p>
<p>CVE Mitre Assigned: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26894">CVE-2020-26894</a></p>
<h1 id="header-2discovery"><a href="#header-2"></a>Discovery</h1>
<p>While taking a Wildlife Issues course at my University, I discovered a high severity vulnerability in the course software our class was using that leads to a horizontal privilege escalation.</p>
<p>At first, I thought the vulnerability was only in this course software, but looking into it deeper and with the help of one of the developers at faulkner press, we discovered that the vulnerability actually lied in the programming language/framework they were using: LiveCode.</p>
<p>For those who aren&rsquo;t familiar, <a href="https://livecode.com/">LiveCode</a> is a high-level scripting language belonging to the family of xTalk scripting languages along side HypderCard&rsquo;s <a href="https://en.wikipedia.org/wiki/HyperTalk">HyperTalk</a>, allowing you to build cross-platform applications with relative ease.</p>
<h1 id="header-3vulnerability"><a href="#header-3"></a>Vulnerability</h1>
<p>LiveCode has a function called &ldquo;shell()&rdquo; which, as you would expect, allows you to run shell commands and store its output. Most high-level programming languages that have a similar shell command function will use the environment variable %COMSPEC in Windows to determine the location of the shell to use to run the command, unless otherwise specified by the programmer. For Linux, it will usually use &ldquo;/bin/sh&rdquo;.</p>
<p>LiveCode v9.6.1, however, does not reference %COMSPEC when attempting to locate cmd.exe to run the &ldquo;shell()&rdquo; function. This is dangerous, since it means it will follow the <a href="https://docs.microsoft.com/en-us/previous-versions//cc723564(v=technet.10)#command-search-sequence">command search sequence</a>. This will force the application to check the current directory of the application for cmd.exe before checking %PATH.</p>
<p>This means that if the folder the application is running in is world writable (such as being installed in the root drive), then a low privileged user can create a malicious cmd.exe in that folder, which will be executed every time the application is started by any user on the system, and will assume the privileges of that user. This is known as horizontal privilege escalation.</p>
<p>After contacting LiveCode, the vulnerability has been patched in LiveCode 9.6.2-rc-1</p>
<p>Commit: <a href="https://github.com/livecode/livecode/commit/9bd23b2008a51c9913513c1af014a76a9ff67dbe">9bd23b2</a> &amp; <a href="https://github.com/livecode/livecode-ide/commit/f309d60d2323c08b7d04425be3fef0c805808c5c">f309d60</a></p>
<p>LiveCode Bug Report: <a href="https://quality.livecode.com/show_bug.cgi?id=22942">https://quality.livecode.com/show_bug.cgi?id=22942</a></p>
<p>CVE Mitre Assigned: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26894">CVE-2020-26894</a></p>
<h1 id="header-4workaround"><a href="#header-4"></a>Workaround</h1>
<p>For those who need a workaround and can&rsquo;t update, use the following command to tell the &ldquo;shell()&rdquo; function to use C:\Windows\System32\cmd.exe</p>
<pre><code>set the shellCommand to &quot;C:\Windows\System32\cmd.exe&quot;
</code></pre><h1 id="header-5proof-of-concept"><a href="#header-5"></a>Proof-of-Concept</h1>
<p>The following is code that is vulnerable to cmd.exe hijacking:
<img src="/assets/2020-10-21-LiveCode-Privilege-Escalation-Vulnerability/1.png" alt="">{:height=&ldquo;100%&rdquo; width=&ldquo;100%&rdquo; style=&ldquo;display: block; margin-right: auto;&quot;}</p>
<p>As you can see below, procmon shows that the vulnerable application is attempting to first get &ldquo;cmd.exe&rdquo; from the folder the application is running in before using C:\Windows\System32\cmd.exe.
<img src="/assets/2020-10-21-LiveCode-Privilege-Escalation-Vulnerability/2.png" alt="">{:height=&ldquo;100%&rdquo; width=&ldquo;100%&rdquo; style=&ldquo;display: block; margin-right: auto;&quot;}</p>
<p>And below is a PoC exploitation of the vulnerable application to pop calc by simply copying calc.exe into the folder of the application and naming it cmd.exe.
<img src="/assets/2020-10-21-LiveCode-Privilege-Escalation-Vulnerability/3.png" alt="">{:height=&ldquo;100%&rdquo; width=&ldquo;100%&rdquo; style=&ldquo;display: block; margin-right: auto;&quot;}</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://john-woodman.com/categories/posts/">posts</a></span>
        
    </p>

  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
            
                <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://john-woodman.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
